(()=>{"use strict";var t={56:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},72:t=>{var e=[];function n(t){for(var n=-1,o=0;o<e.length;o++)if(e[o].identifier===t){n=o;break}return n}function o(t,o){for(var s={},i=[],a=0;a<t.length;a++){var l=t[a],c=o.base?l[0]+o.base:l[0],d=s[c]||0,p="".concat(c," ").concat(d);s[c]=d+1;var u=n(p),f={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==u)e[u].references++,e[u].updater(f);else{var g=r(f,o);o.byIndex=a,e.splice(a,0,{identifier:p,updater:g,references:1})}i.push(p)}return i}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var s=o(t=t||[],r=r||{});return function(t){t=t||[];for(var i=0;i<s.length;i++){var a=n(s[i]);e[a].references--}for(var l=o(t,r),c=0;c<s.length;c++){var d=n(s[c]);0===e[d].references&&(e[d].updater(),e.splice(d,1))}s=l}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},208:(t,e,n)=>{n.d(e,{A:()=>a});var o=n(601),r=n.n(o),s=n(314),i=n.n(s)()(r());i.push([t.id,"body {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    font-family: sans-serif;\n    margin: 0;\n    background-color: #333;\n}\n\n.controls {\n    width: 800px;\n    margin-bottom: 20px;\n    padding: 10px;\n    text-align: right;\n}\n\n.controls button {\n    margin-left: 10px;\n}\n\n.buffer-zone,\n.working-zone {\n    width: 800px;\n    height: 300px;\n    border: 1px solid #777;\n    margin-bottom: 20px;\n    overflow: hidden;\n    position: relative;\n}\n\n.buffer-zone {\n    background-color: #444;\n}\n\n.working-zone {\n    background-color: #444;\n    background-image:\n        linear-gradient(to right, #555 1px, transparent 1px),\n        linear-gradient(to bottom, #555 1px, transparent 1px);\n    background-size: 20px 20px;\n    position: relative;\n}\n\n.working-zone-content {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    transform-origin: 0 0;\n}\n\n.coord-scale-x,\n.coord-scale-y {\n    position: absolute;\n    color: #bbb;\n    font-size: 10px;\n    pointer-events: none;\n    z-index: 1;\n}\n\n.coord-scale-x {\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    display: flex;\n    justify-content: space-between;\n    padding: 0 5px;\n}\n\n.coord-scale-y {\n    top: 0;\n    left: 0;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    padding: 5px 0;\n    text-align: right;\n}\n\nsvg-polygon::shadow polygon {\n    fill: #c0392b;\n} ",""]);const a=i},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",o=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),o&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),o&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,o,r,s){"string"==typeof t&&(t=[[null,t,void 0]]);var i={};if(o)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(i[l]=!0)}for(var c=0;c<t.length;c++){var d=[].concat(t[c]);o&&i[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),e.push(d))}},e}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},601:t=>{t.exports=function(t){return t[1]}},659:t=>{var e={};t.exports=function(t,n){var o=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,r&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(o,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var s=e[o]={id:o,exports:{}};return t[o](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0;var o=n(72),r=n.n(o),s=n(825),i=n.n(s),a=n(659),l=n.n(a),c=n(56),d=n.n(c),p=n(540),u=n.n(p),f=n(113),g=n.n(f),h=n(208),y={};y.styleTagTransform=g(),y.setAttributes=d(),y.insert=l().bind(null,"head"),y.domAPI=i(),y.insertStyleElement=u(),r()(h.A,y),h.A&&h.A.locals&&h.A.locals;class m extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}).innerHTML='\n            <style>\n                :host {\n                    display: block;\n                    cursor: grab;\n                    position: absolute; /* Make polygons positionable */\n                    /* Set initial size for drag calculations */\n                    width: 100px;\n                    height: 100px;\n                }\n                svg {\n                    width: 100%;\n                    height: 100%;\n                }\n            </style>\n            <svg viewBox="0 0 100 100"></svg>\n        ',this.isDragging=!1,this.offsetX=0,this.offsetY=0,this.addEventListener("mousedown",this.onMouseDown.bind(this))}set points(t){const e=this.shadowRoot.querySelector("svg");let n=e.querySelector("polygon");n||(n=document.createElementNS("http://www.w3.org/2000/svg","polygon"),e.appendChild(n)),n.setAttribute("points",t),n.setAttribute("fill","red")}onMouseDown(t){this.parentElement===M&&(this.isDragging=!0,this.offsetX=t.clientX-this.getBoundingClientRect().left,this.offsetY=t.clientY-this.getBoundingClientRect().top,this.style.cursor="grabbing",t.stopPropagation())}setPosition(t,e){this.style.position="absolute",this.style.left=`${t}px`,this.style.top=`${e}px`}}customElements.define("svg-polygon",m);const v=document.getElementById("create-btn"),b=document.getElementById("save-btn"),x=document.getElementById("reset-btn"),w=document.querySelector(".buffer-zone"),A=document.querySelector(".working-zone"),M=document.querySelector(".working-zone-content"),E=document.querySelector(".coord-scale-x"),S=document.querySelector(".coord-scale-y");let C=1,L=0,k=0,T=!1,$=0,z=0;function B(){M.style.transform=`translate(${L}px, ${k}px) scale(${C})`,A.style.backgroundSize=`${20*C}px ${20*C}px`,function(){E.innerHTML="",S.innerHTML="";const t=A.getBoundingClientRect();let e=100;C<.5&&(e=200),C<.2&&(e=500),C>1.5&&(e=50),C>3&&(e=20),C>6&&(e=10);const n=-L/C,o=-k/C,r=n+t.width/C,s=o+t.height/C;for(let o=Math.floor(n/e)*e;o<r;o+=e){const e=o*C+L;if(e>=0&&e<=t.width){const t=document.createElement("span");t.textContent=Math.round(o),t.style.position="absolute",t.style.left=`${e}px`,t.style.transform="translateX(-50%)",t.style.bottom="5px",E.appendChild(t)}}for(let n=Math.floor(o/e)*e;n<s;n+=e){const e=n*C+k;if(e>=0&&e<=t.height){const t=document.createElement("span");t.textContent=Math.round(n),t.style.position="absolute",t.style.top=`${e}px`,t.style.transform="translateY(-50%)",t.style.right="5px",S.appendChild(t)}}}()}function I(t){const e=[];for(let n=0;n<t;n++){const t=2*Math.random()*Math.PI,n=40*Math.random(),o=50+n*Math.cos(t),r=50+n*Math.sin(t);e.push(`${o},${r}`)}return e.join(" ")}v.addEventListener("click",(()=>{const t=Math.floor(16*Math.random())+5;w.innerHTML="";for(let e=0;e<t;e++){const t=I(Math.floor(5*Math.random())+3),e=new m;e.points=t;const n=w.clientWidth,o=w.clientHeight,r=100,s=Math.random()*(n-r),i=Math.random()*(o-r);e.style.position="absolute",e.style.left=`${s}px`,e.style.top=`${i}px`,e.style.width=`${r}px`,e.style.height=`${r}px`,e.setAttribute("draggable",!0),w.appendChild(e)}}));let Y=null;document.addEventListener("dragstart",(t=>{if("SVG-POLYGON"===t.target.tagName){Y=t.target;const e=Y.getBoundingClientRect();Y.dragOffsetX=t.clientX-e.left,Y.dragOffsetY=t.clientY-e.top;const n=new Image;n.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=",t.dataTransfer.setDragImage(n,0,0),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain","")}})),document.addEventListener("dragover",(t=>{t.preventDefault(),(t.target===w||t.target===M||t.target.closest(".buffer-zone")||t.target.closest(".working-zone-content"))&&(t.dataTransfer.dropEffect="move")})),document.addEventListener("drop",(t=>{if(t.preventDefault(),Y){const e=t.target.closest(".buffer-zone")||t.target.closest(".working-zone-content");if(e){const n=e.getBoundingClientRect(),o=t.clientX-n.left,r=t.clientY-n.top;let s,i;if(e===M){const n=(t.clientX-A.getBoundingClientRect().left-L)/C,o=(t.clientY-A.getBoundingClientRect().top-k)/C;s=n-Y.dragOffsetX/C,i=o-Y.dragOffsetY/C,e.appendChild(Y),Y.style.position="absolute",Y.style.left=`${s}px`,Y.style.top=`${i}px`}else Y.getBoundingClientRect(),s=o-Y.dragOffsetX,i=r-Y.dragOffsetY,e.appendChild(Y),Y.style.position="absolute",Y.style.left=`${s}px`,Y.style.top=`${i}px`}Y=null}})),document.addEventListener("dragstart",(t=>{"IMG"===t.target.tagName&&t.preventDefault()})),A.addEventListener("wheel",(t=>{t.preventDefault();const e=t.deltaY>0?.9:1.1,n=C*e;if(n>.1&&n<10){const e=A.getBoundingClientRect(),o=t.clientX-e.left,r=t.clientY-e.top;L=o-n/C*(o-L),k=r-n/C*(r-k),C=n,B()}})),A.addEventListener("mousedown",(t=>{0===t.button&&t.target===A&&(T=!0,$=t.clientX,z=t.clientY,A.style.cursor="grabbing")})),document.addEventListener("mousemove",(t=>{if(T){const e=t.clientX-$,n=t.clientY-z;L+=e,k+=n,$=t.clientX,z=t.clientY,B()}})),document.addEventListener("mouseup",(()=>{T=!1,A.style.cursor="default"})),b.addEventListener("click",(function(){const t=[];M.querySelectorAll("svg-polygon").forEach((e=>{const n=e.shadowRoot.querySelector("svg").querySelector("polygon"),o=n?n.getAttribute("points"):"";t.push({points:o,left:e.style.left,top:e.style.top,width:e.style.width,height:e.style.height})})),localStorage.setItem("savedPolygons",JSON.stringify(t)),console.log("Polygons saved to localStorage.")})),x.addEventListener("click",(function(){localStorage.removeItem("savedPolygons"),M.innerHTML="",console.log("Polygons reset.")})),window.addEventListener("load",(()=>{!function(){const t=localStorage.getItem("savedPolygons");if(t){const e=JSON.parse(t);M.innerHTML="",e.forEach((t=>{const e=new m;e.points=t.points,e.style.position="absolute",e.style.left=t.left,e.style.top=t.top,e.style.width=t.width,e.style.height=t.height,e.setAttribute("draggable",!0),M.appendChild(e)})),console.log("Polygons loaded from localStorage.")}}(),B()}))})();